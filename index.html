<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode & QR Code Scanner</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsQR/1.4.0/jsQR.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 100%;
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        header p {
            font-size: 14px;
            opacity: 0.9;
        }

        main {
            padding: 30px 20px;
        }

        section {
            margin-bottom: 25px;
        }

        .scanner-area {
            text-align: center;
        }

        video {
            width: 100%;
            border-radius: 15px;
            background: #f0f0f0;
            margin-bottom: 20px;
            display: none;
        }

        video.active {
            display: block;
        }

        .placeholder {
            width: 100%;
            height: 300px;
            background: #f5f5f5;
            border: 2px dashed #ddd;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .placeholder.hidden {
            display: none;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-start {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-stop {
            background: #ff6b6b;
            color: white;
        }

        .btn-stop:hover {
            background: #ee5a52;
            transform: translateY(-2px);
        }

        .btn-clear {
            background: #e0e0e0;
            color: #333;
        }

        .btn-clear:hover {
            background: #d0d0d0;
        }

        .results h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .result-item {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .result-text {
            flex: 1;
            text-align: left;
            word-break: break-all;
            font-size: 13px;
            color: #333;
        }

        .result-type {
            font-size: 11px;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: 600;
            min-width: 50px;
        }

        .copy-btn {
            background: none;
            border: none;
            color: #667eea;
            cursor: pointer;
            padding: 5px;
            transition: color 0.3s;
            font-size: 16px;
        }

        .copy-btn:hover {
            color: #764ba2;
        }

        .empty-state {
            text-align: center;
            color: #999;
            font-size: 14px;
            padding: 20px;
        }

        .status {
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            font-size: 13px;
            margin-bottom: 15px;
            display: none;
        }

        .status.active {
            display: block;
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status.success {
            display: block;
            background: #e3f2fd;
            color: #1565c0;
        }

        canvas {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ“± Scanner</h1>
            <p>Scan barcodes &amp; QR codes instantly</p>
        </header>

        <main>
            <section class="scanner-area">
                <div class="status" id="status"></div>
                <div class="placeholder" id="placeholder">
                    ðŸ“· Camera preview will appear here
                </div>
                <video id="video" playsinline=""></video>
                <canvas id="canvas"></canvas>

                <div class="controls">
                    <button class="btn-start" onclick="startScanning()">Start Scanning</button>
                    <button class="btn-stop" onclick="stopScanning()">Stop</button>
                    <button class="btn-clear" onclick="clearResults()">Clear</button>
                </div>
            </section>

            <section class="results">
                <h2>Scanned Results</h2>
                <div id="results">
                    <div class="empty-state">No codes scanned yet</div>
                </div>
            </section>
        </main>
    </div>

    <script>
        var scanning = false;
        var scannedCodes = [];
        var videoEl = document.getElementById('video');
        var canvasEl = document.getElementById('canvas');
        var resultsEl = document.getElementById('results');
        var placeholderEl = document.getElementById('placeholder');
        var statusEl = document.getElementById('status');

        function startScanning() {
            statusEl.textContent = 'Requesting camera access...';
            statusEl.className = 'status active';
            
            navigator.mediaDevices.getUserMedia({
                video: { facingMode: 'environment', width: { ideal: 1280 }, height: { ideal: 720 } }
            }).then(function(stream) {
                videoEl.srcObject = stream;
                videoEl.classList.add('active');
                placeholderEl.classList.add('hidden');
                statusEl.textContent = 'Camera active - Point at a barcode or QR code';
                statusEl.className = 'status success';
                
                scanning = true;
                processFrame();
            }).catch(function(err) {
                statusEl.textContent = 'Camera access denied. Please enable camera permissions.';
                statusEl.className = 'status active';
                console.error(err);
            });
        }

        function stopScanning() {
            scanning = false;
            if (videoEl.srcObject) {
                var tracks = videoEl.srcObject.getTracks();
                for (var i = 0; i < tracks.length; i++) {
                    tracks[i].stop();
                }
            }
            videoEl.classList.remove('active');
            placeholderEl.classList.remove('hidden');
            statusEl.textContent = '';
            statusEl.className = 'status';
        }

        function processFrame() {
            if (!scanning) return;

            var ctx = canvasEl.getContext('2d');
            canvasEl.width = videoEl.videoWidth;
            canvasEl.height = videoEl.videoHeight;
            ctx.drawImage(videoEl, 0, 0);

            var imageData = ctx.getImageData(0, 0, canvasEl.width, canvasEl.height);
            var code = jsQR(imageData.data, imageData.width, imageData.height);

            if (code) {
                addResult(code.data, 'QR Code');
            }

            requestAnimationFrame(processFrame);
        }

        function addResult(text, type) {
            var exists = false;
            for (var i = 0; i < scannedCodes.length; i++) {
                if (scannedCodes[i].text === text) {
                    exists = true;
                    break;
                }
            }
            
            if (!exists) {
                scannedCodes.unshift({ text: text, type: type, time: new Date().toLocaleTimeString() });
                renderResults();
            }
        }

        function renderResults() {
            if (scannedCodes.length === 0) {
                resultsEl.innerHTML = '<div class="empty-state">No codes scanned yet</div>';
                return;
            }

            var html = '';
            for (var i = 0; i < scannedCodes.length; i++) {
                var item = scannedCodes[i];
                html += '<div class="result-item">' +
                    '<span class="result-type">' + item.type + '</span>' +
                    '<span class="result-text">' + item.text + '</span>' +
                    '<button class="copy-btn" onclick="copyToClipboard(' + i + ')">ðŸ“‹</button>' +
                    '</div>';
            }
            resultsEl.innerHTML = html;
        }

        function copyToClipboard(idx) {
            var text = scannedCodes[idx].text;
            navigator.clipboard.writeText(text).then(function() {
                var buttons = document.querySelectorAll('.copy-btn');
                if (buttons[idx]) {
                    buttons[idx].textContent = 'âœ…';
                    setTimeout(function() {
                        buttons[idx].textContent = 'ðŸ“‹';
                    }, 2000);
                }
            });
        }

        function clearResults() {
            scannedCodes = [];
            renderResults();
        }

        renderResults();
    </script>
</body>
</html>
